<div class="notifications-container">
  <div class="notifications-header">
    <h1>Prefer√™ncias de Notifica√ß√£o</h1>
    <p>Configure como voc√™ deseja receber alertas sobre seus ve√≠culos</p>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Carregando prefer√™ncias...</p>
  </div>

  <div *ngIf="!loading" class="notifications-content">
    <!-- Prefer√™ncias de Notifica√ß√£o -->
    <div class="preferences-section">
      <h3>Canais de Notifica√ß√£o</h3>

      <div class="preference-item">
        <div class="preference-header">
          <h4>üìß Email</h4>
          <label class="switch">
            <input
              type="checkbox"
              [(ngModel)]="preferences.emailEnabled"
              [disabled]="submitting"
            />
            <span class="slider"></span>
          </label>
        </div>
        <p>Receba alertas por email</p>
      </div>

      <div class="preference-item">
        <div class="preference-header">
          <h4>üí¨ WhatsApp</h4>
          <label class="switch">
            <input
              type="checkbox"
              [(ngModel)]="preferences.whatsappEnabled"
              [disabled]="submitting"
            />
            <span class="slider"></span>
          </label>
        </div>
        <p>Receba alertas por WhatsApp</p>
        <div *ngIf="preferences.whatsappEnabled" class="whatsapp-status">
          <p *ngIf="whatsappStatus.connected">
            ‚úÖ WhatsApp conectado: {{ whatsappStatus.phoneNumber }}
          </p>
          <p *ngIf="!whatsappStatus.connected">
            ‚ö†Ô∏è WhatsApp n√£o conectado
          </p>
          <button
            (click)="toggleWhatsappForm()"
            class="btn btn-small"
            [disabled]="submitting"
          >
            {{ whatsappStatus.connected ? 'Desconectar' : 'Conectar' }} WhatsApp
          </button>
        </div>
      </div>

      <div class="preference-item">
        <div class="preference-header">
          <h4>üîî Notifica√ß√£o Push</h4>
          <label class="switch">
            <input
              type="checkbox"
              [(ngModel)]="preferences.pushEnabled"
              [disabled]="submitting"
            />
            <span class="slider"></span>
          </label>
        </div>
        <p>Receba notifica√ß√µes push no seu dispositivo (com som de buzina)</p>
      </div>

      <!-- Bot√£o de Salvar -->
      <button
        (click)="updatePreferences()"
        class="btn btn-primary"
        [disabled]="submitting"
      >
        {{ submitting ? 'Salvando...' : 'Salvar Prefer√™ncias' }}
      </button>
    </div>

    <!-- Formul√°rio de Conex√£o WhatsApp -->
    <div *ngIf="showWhatsappForm" class="whatsapp-form">
      <h3>Conectar WhatsApp</h3>
      <p>Informe seu n√∫mero de telefone para conectar ao WhatsApp</p>

      <div class="form-group">
        <label for="phoneNumber">N√∫mero de Telefone</label>
        <input
          type="tel"
          id="phoneNumber"
          [(ngModel)]="phoneNumber"
          placeholder="Ex: 11999999999"
          class="form-control"
          [disabled]="submitting"
        />
        <small>Digite apenas n√∫meros (ex: 11999999999)</small>
      </div>

      <div class="form-actions">
        <button
          (click)="connectWhatsapp()"
          class="btn btn-primary"
          [disabled]="submitting"
        >
          {{ submitting ? 'Conectando...' : 'Conectar' }}
        </button>
        <button
          (click)="toggleWhatsappForm()"
          class="btn btn-secondary"
          [disabled]="submitting"
        >
          Cancelar
        </button>
      </div>

      <!-- QR Code -->
      <div *ngIf="qrCode" class="qr-code">
        <p>Escaneie este QR code com seu WhatsApp:</p>
        <img [src]="qrCode" alt="QR Code" />
      </div>
    </div>

    <!-- Informa√ß√µes -->
    <div class="info-section">
      <h3>‚ÑπÔ∏è Informa√ß√µes</h3>
      <ul>
        <li>Email √© o canal padr√£o e recomendado</li>
        <li>WhatsApp requer conex√£o via QR code</li>
        <li>Notifica√ß√µes push funcionam em navegadores e apps</li>
        <li>Voc√™ pode desabilitar qualquer canal a qualquer momento</li>
      </ul>
    </div>
  </div>
</div>
